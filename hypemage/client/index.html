<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Robot Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.prod.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="header">
            <h1>ü§ñ Multi-Robot Dashboard</h1>
            <div class="connection-badges">
                <span :class="['badge', storm.connected ? 'connected' : 'disconnected']">
                    Storm {{ storm.connected ? '‚úì' : '‚úó' }}
                </span>
                <span :class="['badge', necron.connected ? 'connected' : 'disconnected']">
                    Necron {{ necron.connected ? '‚úì' : '‚úó' }}
                </span>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Both View -->
            <div v-if="currentView === 'both'" class="both-view">
                <div class="robot-column">
                    <h2 class="robot-title">‚ö° Storm</h2>
                    <div class="widgets-container">
                        <!-- Controls -->
                        <div v-if="storm.visibleWidgets.has('controls')" class="widget">
                            <h3>üéÆ Control</h3>
                            <div class="button-group">
                                <button @click="startRobotDebug('storm')" :disabled="storm.status === 'running'" class="btn btn-primary">‚ñ∂Ô∏è Debug</button>
                                <button @click="stopRobot('storm')" :disabled="storm.status !== 'running'" class="btn btn-danger">‚èπÔ∏è Stop</button>
                            </div>
                            <div class="status-info">
                                <p><strong>Status:</strong> {{ storm.status }}</p>
                                <p><strong>PID:</strong> {{ storm.pid || '-' }}</p>
                            </div>
                        </div>
                        
                        <!-- Camera -->
                        <div v-if="storm.visibleWidgets.has('camera')" class="widget camera-widget">
                            <h3>üì∑ Camera <span v-if="storm.camera.fps">{{ storm.camera.fps }} FPS</span></h3>
                            <img v-if="storm.camera.frame" :src="storm.camera.frame" alt="Camera feed">
                            <div v-else class="no-feed">No camera feed</div>
                        </div>
                        
                        <!-- Motors -->
                        <div v-if="storm.visibleWidgets.has('motors')" class="widget">
                            <h3>‚öôÔ∏è Motors</h3>
                            <div class="motors-grid">
                                <div v-for="(speed, i) in storm.motors.speeds" :key="i" class="motor-item">
                                    <div class="motor-label">M{{ i }}</div>
                                    <div class="motor-bar">
                                        <div class="motor-fill" :style="{width: Math.abs(speed) + '%', backgroundColor: speed >= 0 ? '#00ff88' : '#ff4444'}"></div>
                                    </div>
                                    <div class="motor-value">{{ speed }}%</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Status -->
                        <div v-if="storm.visibleWidgets.has('status')" class="widget">
                            <h3>‚ÑπÔ∏è Status</h3>
                            <p><strong>Host:</strong> {{ storm.host }}</p>
                            <p><strong>Connected:</strong> {{ storm.connected ? 'Yes' : 'No' }}</p>
                        </div>
                    </div>
                </div>
                
                <div class="robot-column">
                    <h2 class="robot-title">üíÄ Necron</h2>
                    <div class="widgets-container">
                        <!-- Controls -->
                        <div v-if="necron.visibleWidgets.has('controls')" class="widget">
                            <h3>üéÆ Control</h3>
                            <div class="button-group">
                                <button @click="startRobotDebug('necron')" :disabled="necron.status === 'running'" class="btn btn-primary">‚ñ∂Ô∏è Debug</button>
                                <button @click="stopRobot('necron')" :disabled="necron.status !== 'running'" class="btn btn-danger">‚èπÔ∏è Stop</button>
                            </div>
                            <div class="status-info">
                                <p><strong>Status:</strong> {{ necron.status }}</p>
                                <p><strong>PID:</strong> {{ necron.pid || '-' }}</p>
                            </div>
                        </div>
                        
                        <!-- Camera -->
                        <div v-if="necron.visibleWidgets.has('camera')" class="widget camera-widget">
                            <h3>üì∑ Camera <span v-if="necron.camera.fps">{{ necron.camera.fps }} FPS</span></h3>
                            <img v-if="necron.camera.frame" :src="necron.camera.frame" alt="Camera feed">
                            <div v-else class="no-feed">No camera feed</div>
                        </div>
                        
                        <!-- Motors -->
                        <div v-if="necron.visibleWidgets.has('motors')" class="widget">
                            <h3>‚öôÔ∏è Motors</h3>
                            <div class="motors-grid">
                                <div v-for="(speed, i) in necron.motors.speeds" :key="i" class="motor-item">
                                    <div class="motor-label">M{{ i }}</div>
                                    <div class="motor-bar">
                                        <div class="motor-fill" :style="{width: Math.abs(speed) + '%', backgroundColor: speed >= 0 ? '#00ff88' : '#ff4444'}"></div>
                                    </div>
                                    <div class="motor-value">{{ speed }}%</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Status -->
                        <div v-if="necron.visibleWidgets.has('status')" class="widget">
                            <h3>‚ÑπÔ∏è Status</h3>
                            <p><strong>Host:</strong> {{ necron.host }}</p>
                            <p><strong>Connected:</strong> {{ necron.connected ? 'Yes' : 'No' }}</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Storm Single View -->
            <div v-if="currentView === 'storm'" class="single-view">
                <h2 class="robot-title">‚ö° Storm - Detailed View</h2>
                <div class="widgets-container expanded">
                    <div v-if="storm.visibleWidgets.has('controls')" class="widget">
                        <h3>üéÆ Control</h3>
                        <div class="button-group">
                            <button @click="startRobotDebug('storm')" :disabled="storm.status === 'running'" class="btn btn-primary">‚ñ∂Ô∏è Debug</button>
                            <button @click="stopRobot('storm')" :disabled="storm.status !== 'running'" class="btn btn-danger">‚èπÔ∏è Stop</button>
                        </div>
                        <div class="status-info">
                            <p><strong>Status:</strong> {{ storm.status }}</p>
                            <p><strong>PID:</strong> {{ storm.pid || '-' }}</p>
                        </div>
                    </div>
                    <div v-if="storm.visibleWidgets.has('camera')" class="widget camera-widget">
                        <h3>üì∑ Camera <span v-if="storm.camera.fps">{{ storm.camera.fps }} FPS</span></h3>
                        <img v-if="storm.camera.frame" :src="storm.camera.frame" alt="Camera feed">
                        <div v-else class="no-feed">No camera feed</div>
                    </div>
                    <div v-if="storm.visibleWidgets.has('motors')" class="widget">
                        <h3>‚öôÔ∏è Motors</h3>
                        <div class="motors-grid">
                            <div v-for="(speed, i) in storm.motors.speeds" :key="i" class="motor-item">
                                <div class="motor-label">M{{ i }}</div>
                                <div class="motor-bar">
                                    <div class="motor-fill" :style="{width: Math.abs(speed) + '%', backgroundColor: speed >= 0 ? '#00ff88' : '#ff4444'}"></div>
                                </div>
                                <div class="motor-value">{{ speed }}%</div>
                            </div>
                        </div>
                    </div>
                    <div v-if="storm.visibleWidgets.has('status')" class="widget">
                        <h3>‚ÑπÔ∏è Status</h3>
                        <p><strong>Host:</strong> {{ storm.host }}</p>
                        <p><strong>Connected:</strong> {{ storm.connected ? 'Yes' : 'No' }}</p>
                    </div>
                </div>
            </div>

            <!-- Necron Single View -->
            <div v-if="currentView === 'necron'" class="single-view">
                <h2 class="robot-title">üíÄ Necron - Detailed View</h2>
                <div class="widgets-container expanded">
                    <div v-if="necron.visibleWidgets.has('controls')" class="widget">
                        <h3>üéÆ Control</h3>
                        <div class="button-group">
                            <button @click="startRobotDebug('necron')" :disabled="necron.status === 'running'" class="btn btn-primary">‚ñ∂Ô∏è Debug</button>
                            <button @click="stopRobot('necron')" :disabled="necron.status !== 'running'" class="btn btn-danger">‚èπÔ∏è Stop</button>
                        </div>
                        <div class="status-info">
                            <p><strong>Status:</strong> {{ necron.status }}</p>
                            <p><strong>PID:</strong> {{ necron.pid || '-' }}</p>
                        </div>
                    </div>
                    <div v-if="necron.visibleWidgets.has('camera')" class="widget camera-widget">
                        <h3>üì∑ Camera <span v-if="necron.camera.fps">{{ necron.camera.fps }} FPS</span></h3>
                        <img v-if="necron.camera.frame" :src="necron.camera.frame" alt="Camera feed">
                        <div v-else class="no-feed">No camera feed</div>
                    </div>
                    <div v-if="necron.visibleWidgets.has('motors')" class="widget">
                        <h3>‚öôÔ∏è Motors</h3>
                        <div class="motors-grid">
                            <div v-for="(speed, i) in necron.motors.speeds" :key="i" class="motor-item">
                                <div class="motor-label">M{{ i }}</div>
                                <div class="motor-bar">
                                    <div class="motor-fill" :style="{width: Math.abs(speed) + '%', backgroundColor: speed >= 0 ? '#00ff88' : '#ff4444'}"></div>
                                </div>
                                <div class="motor-value">{{ speed }}%</div>
                            </div>
                        </div>
                    </div>
                    <div v-if="necron.visibleWidgets.has('status')" class="widget">
                        <h3>‚ÑπÔ∏è Status</h3>
                        <p><strong>Host:</strong> {{ necron.host }}</p>
                        <p><strong>Connected:</strong> {{ necron.connected ? 'Yes' : 'No' }}</p>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <div class="view-switcher">
                <button :class="['view-btn', {active: currentView === 'both'}]" @click="currentView = 'both'">Both</button>
                <button :class="['view-btn', {active: currentView === 'storm'}]" @click="currentView = 'storm'">Storm</button>
                <button :class="['view-btn', {active: currentView === 'necron'}]" @click="currentView = 'necron'">Necron</button>
            </div>
            <div class="widget-toggles">
                <span class="toggle-label">Show:</span>
                <label v-for="widget in availableWidgets" :key="widget.id" class="toggle">
                    <input type="checkbox" :checked="isWidgetVisible(currentView, widget.id)" @change="toggleWidgetForCurrentView(widget.id)">
                    <span>{{ widget.icon }} {{ widget.name }}</span>
                </label>
            </div>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>